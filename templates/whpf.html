<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>WHPF</title>
    <style>
      .player-picture{
        display: inline-block;
        height: 0px;
        width: 0px;
        padding: 70px 115px 70px 115px;
      }

      .team-picture{
        width: 15%;
      }
    </style>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

  </head>
  <body>
    <div class="container">
      <h1>WHO HE PLAY FOR <small><span class="guessed"></span>/<span class="total"></span></small></h1>
      <h2>Round <span class="round"></span></h2>
      <div class="row">
        <div class="col-sm-4 text-center player">
          <h2 class="player-name"></h2>
          <img class="player-picture" />
        </div>

        <div class="col-sm-4 text-center">
          <h2>Your guess</h2>
          <div id="teams">
          {% for team in teams %}
            <a href="#" id="{{ team.code }}" class="guess"><img title="{{ team.city }} {{ team.name }}" class="team-picture" id="{{ team.code }}" src="{{ team.picture }}" /></a>
          {% endfor %}
          </div>


        </div>
      </div> <!-- row -->
    </div> <!-- container -->

    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <script>
      var player;
      var round = 1;
      var guessed = 0;
    </script>
    <script>
      function initialize(){
        var total = round - 1;
        $(".guessed").html(guessed);
        $(".total").html(total);
        $(".round").html(round);

        $('#resultModal').modal('hide');

        var players = {{ players|tojson }};
        player = players[Math.floor(Math.random() * players.length)];
        $(".player-name").html(player.name);
        $(".player-picture").css("background-image", "url('" + player.picture + "')");
      }

      $(document).ready(function(){
        initialize();
      });

      $("a.guess").click(function(e){
        round += 1;
        e.preventDefault();
        var guess = $(this).attr("id");
        // var player = $(".player-picture").data("playerinfo");
        var answer = player.team.code;
        var player_team = $(".player-picture").data("jsonanswer");
        var result_container = $("#resultModal .modal-body p");
        var modal_title = $("#resultModal .modal-title");
        var img = $(".answer-image");
        img.attr("src", player.team.picture);
        if (guess == answer){
          guessed += 1;
          modal_title.html("SUCCESS");
          result_container.html("Yes, " + player.name + " plays for " + player.team.city + " " + player.team.name);
        } else {
          modal_title.html("FAIL");
          result_container.html("Nooo, " + player.name + " plays for " + player.team.city + " " + player.team.name);
        }
        $('#resultModal').modal();
      });

    </script>

    <!-- modal -->
    <div class="modal fade" tabindex="-1" role="dialog" id="resultModal" data-backdrop="static" data-keyboard="false">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title"></h4>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-xs-2">
                <img style="width: 100%" class="answer-image" />
              </div>
              <div class="col-xs-10">
                <p></p>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <a class="btn btn-danger" href="/">Restart</a>
            <button class="btn btn-success" onClick="initialize();">Next round</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

  </body>
</html>

